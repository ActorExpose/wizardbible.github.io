x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第○章: facebookなりすまし犯人までリバースハッキング ---

著者：57r4yH0n3yB33

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　皆さん、こんにちは。57r4yH0n3yB33です。名前は適当です。
　かつてセキュリティアカデメイアにあったスレッド掲示板では源氏丸と名乗っていました。その節はどうもお世話になりました。

　この度は初めてのWB投稿ですが、簡単な逆ハッキングの成功例をご紹介したいと思います。


■0x02.) 概要

　さて、昨年facebookでなりすましが流行ったのを覚えておりますでしょうか？
　その犯人とふとしたきっかけで出会い、熱い猛アタックを受けました。ラブレターを読んで呼び出されたお家にお邪魔させていただきましたところ、本棚の中からお名前の書かれた分厚いなりすまし名簿を頂きました。
　近年なりすまし事体が無くなったためそろそろ公開してもよいだろうとWBへの投稿を踏み切りました。

　ちなみに、そのお家は現在鍵がかかって入れませんので悪しからず。


■0x03.) 出会い

　ことの始まりは2013年夏、私のfacebookの友人がなりすましにあったのがきっかけでした。そのなりすましは例のごとく友達の友達、つまり私に友達申請を送ってくださいました。私は喜んで承認いたしましたが、残念ながらメールアドレスを教えてくれませんでした。残念に思った私は、彼にコンタクトをとってみました。彼からの返事はありませんでした。所詮遊びだったのね…そう諦めました。

　ちなみにfacebookの友人になると通常設定だと友達のメールアドレスが入手できるのをご存知ですか？
　現在もほぼ全ての友人のメールアドレスをぶっこぬけます。やり方はyahoo.comのサイトに行って、メールの連携欄からfacebookと連携するだけです。
　元々facebookは友人のメールアドレスを見ることを制限していません。Google+などへの移行を検討している人たちへの措置として、Googleにメールアドレスを直接渡したくないので、Yahooからメールアドレスを取得してくださいとのことです。
　私は犯人の目的はそれだと思っております。閑話休題。


■0x04.) 突然のラブレター

　何日も何日も経った時、ふと私のPCが不審なパケットを受信しました（図1参照）。

（図1：http://wizardbible.org/58/facebook/photo1.jpg）不審パケット

　Wiresharkで垂れ流しているパケットから、明らかに特権上昇を模索していることがわかりました。

　例えるなら、エベレストの崖を前に岩の隙間にハーケンを打ち込んでくるような愛おしいパケットを見つけました。私はそれが彼のラブレターとはまったく気付きませんでした。しかし、せっかく頂いた貴重なメッセージ、読まないわけにはいきません。
　慎重に該当ポートを閉じ、例えるなら「そのルートだけに雪を流し、こちらではないですよ」と教えてあげました（図2参照）。

（図2：http://wizardbible.org/58/facebook/photo2.jpg）ポートを閉じた結果

　彼は再び体制を立て直すべく改めて全てのルートを見直し始めました。私はルーターのログをオンにして彼の2回目のアタックを待ちました。
　ほどなくして彼からポートスキャンが行われました（図3参照）。見られているということを露とも思わない大胆なアタックでした。連れてきたゾンビたちを総動員して手当たりしだいドアをガンガンノックする駄目なポートスキャンでした。

（図3：http://wizardbible.org/58/facebook/photo3.jpg）ポートスキャン

　しかも、その中に彼も混じっていました。
　ゾンビの特性を調べている最中に大本営の80番ポートが開いたサーバにアクセスしてしまいました。本来ならここからゾンビたちをばっさばっさ切っていき、ふんずほぐれつの末、運がよければ会話していざご対面という大事なプロセスがあったはずですが、こともあろうか大将軍自ら先頭に立ってぬののふくとひのきのぼうで私の堅固な玄関をどっかんどっかん叩いているのです。もうこうなっては何も魅力を感じません。

　私はインターネットエクスプローラーで彼のWebサイトにアクセスし、家捜しが始まりました（図4参照）。

（図4：http://wizardbible.org/58/facebook/photo4.jpg）Webサイトの構造


■0x05.) 追い込み

　フォルダの最深部には彼の溜めたDBがそのままアップされていました（図5参照）。

（図5：photo5.jpg）DBファイル

　早速sqlを解読してみると、そこにはアドレス、パスワード、苗字、名前、などのセットがおよそ100万件入っていました（図6参照）。

（図6：http://wizardbible.org/58/facebook/photo6.jpg）DBの中身

　最初それは私にしたことを他の人にもして何らかの方法で回収したリアルデータなのかと思いました。しかしよく見ると漢字の名前、カタカナの名前と英語の名前が一致していないなど結構適当なデータでした。
　調べるとそこにはfacebookでなりすましをされた友人の名前が入っていました。そのカラムにあるアドレスとパスワードをfacebookのサイトで入力し見ると…このアカウントはロックされています（図7参照）。

（図7：http://wizardbible.org/58/facebook/photo7.jpg）facebookアカウントのロック画面

　少なくとも本当に使われたアカウントであることがわかりました。もう少しカラムを調べていくと…。
　まずはこちらの画像をご覧ください（図8参照）。

（図8：http://wizardbible.org/58/facebook/photo8.jpg）photoカラム

　photoカラムの「C:Dropbox1 CODE DATA AxxxxxxxxxxxxxPHOTO 02245.jp」（一部、伏字）という文字列を見たときは震えました。
　彼は前世ではきっと名の知れた豪傑だったに違いありません。まさにノーガード戦法でサイバー戦争の引き金を引く命知らずの漢です。
　私は敬意を持って様々な彼のサイトのデータをGoogle先生などに聞いて照合したところ、彼の本名ではなく、いわゆるあだ名みたいなものだと分かりました。


■0x06.) その後

　愛宕警察署のサイバー犯罪の担当に電話してこの事件は幕を閉じます。というか警察もこういったことはあまりよく分からないらしく、正直にいうと現在も放置されています。
　今も彼の会社のHPにアクセスするとWORKというスタイリッシュなタブの下にSNSを活用した宣伝広告と書いて元気に仕事しています（笑）。今は別に彼をどうこうする気もないし、かばう気もありません。
　彼のような元気な若者が日本の代表として将来変わらずのぬののふくとひのきのぼうで、黒客やcDc（古いか…）に挑んでいってくれることを期待しております。

　読んでいただきありがとうございました。またどこかでお会いしましょう＾＾


